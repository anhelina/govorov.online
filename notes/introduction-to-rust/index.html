<!DOCTYPE html> <html lang="ru"> <head> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1"> <title>Николай Говоров | Приправляем наши web проекты Rust&#39;ом</title> <meta name="description" content="Это вводная статья в язык Rust, призванная разобраться нужен ли он вам, и чем он может быть полезен в веб разработке."> <meta property="og:type" content="website"> <meta property="og:title" content="Николай Говоров | Приправляем наши web проекты Rust&#39;ом"> <meta property="og:description" content="Это вводная статья в язык Rust, призванная разобраться нужен ли он вам, и чем он может быть полезен в веб разработке."> <!-- Yandex verification --> <meta name="yandex-verification" content="a85fbaade3d4ec4d" /> <!-- Disable auto detected phone links --> <meta name="format-detection" content="telephone=no"> <!-- Safari --> <meta http-equiv="x-rim-auto-match" content="none"> <!-- BlackBerry --> <link rel="stylesheet" href="/assets/fonts/FiraCode/fira_code.css"> <link rel="stylesheet" href="/assets/main-468870bcb9fbe223339ba43cb6c49d77.css"> <link rel="canonical" href="https://govorov.online/notes/introduction-to-rust/"> <link rel="alternate" type="application/rss+xml" title="Николай Говоров" href="/feed.xml"> <link rel="icon" type="image/png" href="/assets/favicon-952b412960fe098923343d67a720ffbf.png"> </head> <body class="page"> <div class="page__header"> <header class="header"> <picture> <img class="header__avatar" src="https://s.gravatar.com/avatar/72cbf564ef7b21b730ec93a6e3abc9f2?s=120" alt=""> </picture> <div class="header__content"> <p class="header__logo"> Николай Говоров </p> <nav class="navigation " aria-label="Страницы сайта"> <ul class="navigation__list"> <li class="navigation__item"> <a href="/" class="link " > Обо мне </a> </li> <li class="navigation__item"> <a href="/notes/" class="link " > Заметки </a> </li> </ul> </nav> </div> </header> </div> <main class="page__content"><article class="article" itemscope itemtype="http://schema.org/BlogPosting"> <header class="article__header"> <time datetime="2017-10-02T00:00:00+00:00" itemprop="datePublished"> 02.10.2017 </time> <h1 class="article__title h1" itemprop="name headline"> Приправляем наши web проекты Rust&#39;ом </h1> </header> <div itemprop="articleBody"> <p>Это вводная статья в язык Rust, призванная разобраться нужен ли он вам, и чем он может быть полезен в веб разработке.</p> <p>Наверняка ты сталкивался с ситуацией, когда приложение выросло, а производительность упала. Может быть у тебя есть сложные алгоритмы надолго блокирующие поток и требующие много процессорного времени. Ты тратишь силы, но проведённые оптимизации не дают ощутимого результата (особенно если у тебя node).</p> <p>Иногда случается что web-приложению внезапно потребовался доступ к низкоуровневому API системы (например, для dashboard’а с нестандартными метриками системы). Особняком стоит проблема многопоточности. Python и Ruby готовят её плохо, NodeJS не готовит вовсе. А порой хочется.</p> <p>Важное требование в том, что мы не хотим переписывать весь проект. Мы лишь хотим ускорить узкие места. Самым логичным решением кажется <strong>вынести тяжёлую логику в нативные модули</strong>.</p> <p>Прежде чем бежать и нанимать С++ разработчика, я прошу тебя остановиться и хорошенько подумать.</p> <p>Мы привыкли, что С/C++ — must have системной разработки, но, чёрт возьми, давай посмотрим правде в глаза — писать на С++ больно. Мы постоянно стрелляем себе по ногам, валимся с ошибками памяти, пишем тысячи строк кода для очередного велосипеда, а про поддержку зависимостей вообще лучше не вспоминать. Помимо этого разработка кроссплатформенных и переносимых решений требует много лишних телодвижений.</p> <p>Вебу нужен новый <del>геморрой</del> герой!</p> <p>В документации к Rust написано, что Rust — это системный язык программирования, внимание которого сосредоточено на трёх задачах: безопасность, скорость и параллелизм (<a href="http://rurust.github.io/rust_book_ru/src/INTRODUCTION.html">Подробнее</a>).</p> <p>Важно отметить что Rust создавался в компании Mozilla как замена С++ для разработки ядра браузера Firefox.</p> <h3 id="что-необычного-может-rust">Что необычного может Rust:</h3> <p><strong>Читаемый синтаксис</strong>. Rust — язык программирования созданный для разработчиков. Код на нём действительно приятно читать. Например, так может выглядеть Hello Rust:</p><pre><code class="language-rust">fn main() {
    println!("Hello Rust!");
}
</code></pre><p><strong>Скорость</strong>. Собственно, ради этого всё и затевалось. Rust чертвоски быстр, почти так же как и С++, и, само собой, в разы быстрее любого из скриптовых языков.</p> <p><strong>Развитый workflow</strong>. Что удивительно, но удобство разработки и качество инструментов не уступает ни Python, ни Ruby, а о С++ даже речи не идёт. Пакетный менеджер <a href="https://crates.io/">Cargo</a> берёт на себя все вопросы с зависимостями и даже сборкой проектов. Создание нового проекта — одна команда <code>$ cargo new --bin my_app</code>. Можно забыть про сложные Make-файлы, это всё сделано из коробки, просто нажимай <code>$ cargo build</code> или <code>$ cargo build --release</code>. Иными словами, в нашем распоряжении есть всё что нужно: пакетные менеджеры, сборщики, готовые модули для типичных задач.</p> <p><strong>Продуманное тестирование</strong>. В самом простом случае, тест в Rust — это функция, аннотированная атрибутом test:</p><pre><code class="language-rust">#[test]
fn it_works() {
    assert!(true);
}
</code></pre><p>Это смотрится просто очевидно и поставляется из коробки. Можете забыть про многочасовую настройку фреймворков для тестирования. Как можно было догадаться, запускать тесты можно одной командой <code>$ cargo test</code>.</p> <p><strong>Многопоточность</strong>. Это пожалуй основная киллер-фича Rust и одна из целей его создания. Многопточность, с защитой от гонки данных делается в несколько строк:</p><pre><code class="language-rust">use std::thread;

fn process() {
    let handles: Vec&lt;_&gt; = (0..10).map(|_| {
        thread::spawn(|| {
            let mut x = 0;

            for _ in 0..5_000_000 {
                x += 1
            }

            x
        })
    }).collect();

    for h in handles {
        println!("Поток завершился со счётом={}",

        h.join().map_err(|_| "Не удалось соединиться с потоком!").unwrap());
    }
}
</code></pre><p>Более интересные примеры есть в <a href="http://rurust.github.io/rust_book_ru/src/dining-philosophers.html">Книге</a>.</p> <p><strong>Переносимость и кроссплатформенность</strong>. Об этом стоит сказать отдельно. Как уже было сказано, сборку берёт на себя Cargo. Он позволяет очень легко и стандартизированно собирать проекты в динамически библиотеки (.so или .dll), что бы потом подключать их в существующий код. Гарантируется что библиотека будет соблюдать стандарт <a href="https://en.wikipedia.org/wiki/Foreign_function_interface">FFI</a>, а значит мы не завязаны на одной платформе и можем легко перенести биндинг из проекта на python, в проект на node или даже С++. Это ключевое преимущество перед нативными биндингами основанных на стандартах вроде <a href="https://nodejs.org/api/addons.html#addons_n_api">N-API</a>. <a href="http://rurust.github.io/rust_book_ru/src/rust-inside-other-languages.html">Подробнее</a></p> <p><strong>Web Assembler</strong>. Да, так как Rust компилируемый язык без сборщика мусора, он может компилироваться в wasm и эффективно использоваться на клиенте.</p> <p><strong>Документация</strong>. Это стоит вынести в отдельное преимущество. У языка отличная, хорошо структурированная документация. Много инфомации переведено на русский язык.</p> <p>Язык Rust всё ещё находится на стадии активной разработки, но уже сейчас может помочь в разработке сложных высоконагруженных приложений.</p> <p>На этом всё. Я надёюсь что пробудил у вас желание ближе познакомиться с этим языком.</p> <h2 id="библиотека">Библиотека:</h2> <ul> <li><a href="https://www.rust-lang.org">Официальный сайт Rust</a></li> <li><a href="http://rurust.github.io/rust_book_ru">Перевод книги “The Rust Programming Language”</a></li> <li><a href="https://blog.risingstack.com/node-js-native-modules-with-rust/">NodeJS native modules with Rust</a></li> <li><a href="https://medium.com/learning-rust/rust-lets-get-it-started-bdd8de58178d">Rust lets get it started</a></li> <li><a href="https://habrahabr.ru/company/ruvds/blog/343568/?utm_source=twitter.com&amp;utm_medium=social&amp;utm_campaign=[perevod]-kak-rabotaet-js-osobennosti-i">Как работает Web Assembler</a></li> </ul> </div> <div class="article__comments"> <div id="disqus_thread"></div> <script> /** * RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS. * LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/ /* var disqus_config = function () { this.page.url = PAGE_URL; // Replace PAGE_URL with your page's canonical URL variable this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable }; */ var disqus_config = function () { this.page.url = 'https://govorov.online/notes/introduction-to-rust/index.html'; this.page.identifier = 'https://govorov.online/notes/introduction-to-rust/index.html'; }; (function() { var d = document, s = d.createElement('script'); s.src = 'https://govorov-online.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); </script> <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript> </div> </article> <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/androidstudio.min.css"> <script defer src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script> <script defer> function installHighlight() { const codeBlocs = document.querySelectorAll('pre code'); for (const block of codeBlocs) { hljs.highlightBlock(block); } } let interval = setInterval(() => { if (hljs) { clearInterval(interval); installHighlight(); } }, 300); </script> </main> <div class="page__footer"> <footer class="footer"> <div class="footer__nav"> <nav class="navigation navigation--vertical" aria-label="Страницы сайта"> <ul class="navigation__list"> <li class="navigation__item"> <a href="/" class="link link--inverted" > Обо мне </a> </li> <li class="navigation__item"> <a href="/notes/" class="link link--inverted" > Заметки </a> </li> </ul> </nav> </div> <div> <a href="/feed.xml" class="button">Подписаться на блог</a> </div> <div class="contacts"> <ul class="contacts__list"> <li class="contacts_item"> <a class="contacts_link" target="_blank" rel="noopener noreferrer" href="tel:89602605986">8 960 260-59-86</a> </li> <li class="contacts_item"> <a class="contacts_link" target="_blank" rel="noopener noreferrer" href="mailto:me@govorov.online">me@govorov.online</a> </li> <li class="contacts_item"> <a class="contacts_link" target="_blank" rel="noopener noreferrer" href="https://vk.com/nikolay_govorov">ВКонтакте</a> </li> <li class="contacts_item"> <a class="contacts_link" target="_blank" rel="noopener noreferrer" href="https://t.me/nikolay_govorov">Телеграм</a> </li> <li class="contacts_item"> <a class="contacts_link" target="_blank" rel="noopener noreferrer" href="https://twitter.com/govorov_n">Твитер</a> </li> <li class="contacts_item"> <a class="contacts_link" target="_blank" rel="noopener noreferrer" href="https://github.com/nikolay-govorov">ГитХаб</a> </li> <li class="contacts_item"> <a class="contacts_link" target="_blank" rel="noopener noreferrer" href="https://hh.ru/resume/5f634201ff051861bc0039ed1f5075434b5257">Резюме</a> </li> </ul> </div> <span class="small"> &copy; 2015-<span id="footer-current-year">2018</span> Николай Говоров </span> <script> document.getElementById('footer-current-year').textContent = (new Date()).getFullYear(); </script> </footer> </div> <!-- Yandex.Metrika counter --> <script type="text/javascript" > (function (d, w, c) { (w[c] = w[c] || []).push(function() { try { w.yaCounter46619496 = new Ya.Metrika({ id:46619496, clickmap:true, trackLinks:true, accurateTrackBounce:true, webvisor:true, trackHash:true }); } catch(e) { } }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = "https://mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); } })(document, window, "yandex_metrika_callbacks"); </script> <noscript><div><img src="https://mc.yandex.ru/watch/46619496" style="position:absolute; left:-9999px;" alt="" /></div></noscript> <!-- /Yandex.Metrika counter --> </body> </html>
